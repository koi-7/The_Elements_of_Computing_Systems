# 7章 バーチャルマシン#1：スタック操作

## 使用法

```$ ./VMtranslator.py <vm ファイル>```

vm ファイルのあるディレクトリに asm ファイルが出力される

## Parser.py

- 6 章のコードを書き換える

## CodeWriter.py

### writeArithmetic

- 比較ではジャンプのためのラベルを複数用意する必要がある
  - ```(jump0), (jump1), ...``` と添え字付きにして対処

### writePushPop

- pop は記憶すべき情報が push より多いため、情報を上手く保存しておく必要がある
  - スタック領域を使用することで対処
  - 書き込んでも影響のない領域に pop 後の数値格納先アドレスを保存

![](https://user-images.githubusercontent.com/61448492/88874085-27361700-d259-11ea-862c-f546a96c2e7a.png)

## その他

- 7 章は 8 章とセットになっているのである程度コードを省略・簡略化してもよい部分がある
  - 変換前の vm コードを見ながら省けるところは省いて書いた
- CodeWriter.py の setFileName の使用用途が未だにわからない

